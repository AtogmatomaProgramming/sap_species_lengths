discarded_sizes = NA){
measure_ranges <- as.data.frame(measure_ranges)
fishing_ground <- as.character(as.vector(caladero))
measure_ranges_filtered <- measure_ranges[measure_ranges$CALADERO == caladero &
measure_ranges$PROCEDENCIA == "IEO",
c("COD_ESP_CAT", "ESP_CAT", "SEXO", "TALLA")]
measure_ranges_filtered <- measure_ranges_filtered[!is.na(measure_ranges_filtered$TALLA), ]
measure_ranges_filtered$ESP_CAT <- paste0(measure_ranges_filtered$ESP_CAT,
"-",
measure_ranges_filtered$SEXO)
if (is.data.frame(discarded_sizes) && nrow(discarded_sizes) > 0) {
#measure_ranges_filtered <- measure_ranges_filtered[-(measure_ranges_filtered$ESP_CAT %in% discarded_sizes$ESP_CAT &
#                                                       measure_ranges_filtered$TALLA %in% discarded_sizes$TALLA), ]
merge_cols <- c("ESP_CAT", "TALLA")
measure_ranges_filtered <- subset(measure_ranges_filtered,
!(paste(measure_ranges_filtered[, merge_cols]) %in%
paste(discarded_sizes[, merge_cols])))
}
plotter_function <- function(caladero,
measure_ranges,
result_directory,
ver = "alfa",
discarded_sizes = NA){
measure_ranges <- as.data.frame(measure_ranges)
fishing_ground <- as.character(as.vector(caladero))
measure_ranges_filtered <- measure_ranges[measure_ranges$CALADERO == caladero &
measure_ranges$PROCEDENCIA == "IEO",
c("COD_ESP_CAT", "ESP_CAT", "SEXO", "TALLA")]
measure_ranges_filtered <- measure_ranges_filtered[!is.na(measure_ranges_filtered$TALLA), ]
measure_ranges_filtered$ESP_CAT <- paste0(measure_ranges_filtered$ESP_CAT,
"-",
measure_ranges_filtered$SEXO)
if (is.data.frame(discarded_sizes) && nrow(discarded_sizes) > 0) {
#measure_ranges_filtered <- measure_ranges_filtered[-(measure_ranges_filtered$ESP_CAT %in% discarded_sizes$ESP_CAT &
#                                                       measure_ranges_filtered$TALLA %in% discarded_sizes$TALLA), ]
merge_cols <- c("ESP_CAT", "TALLA")
measure_ranges_filtered <- subset(measure_ranges_filtered,
!(paste(measure_ranges_filtered[, merge_cols]) %in%
paste(discarded_sizes[, merge_cols])))
}
plot <- ggplot2::ggplot(data = measure_ranges_filtered, aes(x = ESP_CAT, y = TALLA)) +
ggplot2::stat_boxplot(geom = "errorbar", width = 0.5) +
ggplot2::geom_boxplot(fill = "#4271AE", outlier.colour = "red", alpha = 0.9) +
ggplot2::theme(axis.text.x = ggplot2::element_text(angle = 90, vjust = 0.5, hjust = 1)) +
ggplot2::ggtitle(paste0("DistribuciÃ³n tallas caladero ", fishing_ground))
p <- plotly::ggplotly(plot)
htmlwidgets::saveWidget(
p,
paste0(
getwd(),
"/",
result_directory,
"/grafico_interactivo_tallas_",
ver,
"_",
fishing_ground,
data_source <- paste0(getwd(), "/data/")
#Define the results' directory
result_directory <- "results"
#Import the work files
measure_ranges <- readRDS(paste0(data_source,
